/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  v2006                                 |
|   \\  /    A nd           | Website:  www.openfoam.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      setExprFieldsDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

expressions
(
    UCurrent
    {
        field       UCurrent;
        dimensions  [0 1 -1 0 0 0 0];

//        constants
//        {
//        }

        variables
        (
	"A=0.01"	
	"t0=30.0"
	"nu = 1e-06"	
	"eta=-pos().z()/(2*sqrt(nu*t0))"
	"erf=2.0/sqrt(pi())*sqrt(1-exp(-sqr(eta)))*(sqrt(pi())/2.0+31./200*exp(-sqr(eta))-341./8000*exp(-2.0*sqr(eta)))"
	"x=pos().x()"
	"y=pos().y()"
	"z=pos().z()"
	"isW = (pos().z() <= 0) ? 1 : 0"
	"isA = (pos().z() <= 0) ? 0 : 1"
	 );

        condition
        #{
	  (pos().z() <= 10.050000000)
        #};

        expression
        #{
            vector
            (
	     isW*A*t0*((1+2*sqr(eta))*(1.-erf)-2.0/sqrt(pi())*eta*exp(-sqr(eta)))+isA*A*t0,
	     0,
	     0
	     )#};
    }
);

// ************************************************************************* //
